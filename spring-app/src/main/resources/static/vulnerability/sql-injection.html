<html>
<head>
    <link href="../toastr.min.css" rel="stylesheet"/>
    <script type="text/javascript" src="../jquery-1.12.2.min.js"></script>
    <script type="text/javascript" src="../toastr.min.js"></script>
</head>
<body>
<h4>SQL Injection</h4>
<b>Search Students</b><br>
<label for="name">Name:</label>
<input id="name" type="text" onkeydown = "if (event.keyCode === 13) document.getElementById('search').click()"/>

<br>

<label for="order">Order by:</label>
<select id="order">
    <option value="NAME">Name</option>
    <option value="CAMPUS">Campus</option>
</select>
<br>
<button id="search" onclick="search()">Search</button>
<br>
<div id="results" style="background: #f0f0f0"></div>

Try name=
<li>a</li>
<li>a'; --</li>
<li>a'; DELETE FROM STUDENT; --</li>
<li>a'; DROP TABLE STUDENT; --</li>
Try order=
<li>ID; DROP TABLE STUDENT; --</li>
<script>
    function search() {
        const name = document.getElementById('name').value;
        const order = document.getElementById('order').value;
        document.getElementById('results').innerHTML = "Loading...";
        fetch(`/api/vulnerability/sql-injection?name=${name}&order=${order}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('results').innerHTML =
                    "<ul>"
                    + data.map(e => `<li> ${e}</li>`).join("")
                    + "</ul>";
            });
    }

    search();
</script>
</body>
</html>
