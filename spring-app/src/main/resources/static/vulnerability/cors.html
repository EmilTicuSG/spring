<html>
<head>
    <link href="../toastr.min.css" rel="stylesheet"/>
    <link href="../quill.snow.css" rel="stylesheet"/>
    <script type="text/javascript" src="../quill.js"></script>
    <script type="text/javascript" src="../jquery-1.12.2.min.js"></script>
    <script type="text/javascript" src="../toastr.min.js"></script>
</head>
<body>

<h2>Cross-Origin Resource Sharing (CORS)</h2>
<div style="border:2px solid green">
    <h4>Transfer Money (via JS call, aka AJAX)</h4>
    Recipient Full Name:<input type="text" id="fullName" value="John Doe"/> <br/>
    Recipient IBAN number:<input type="text" id="iban" value="12345678900"/> <br/>
    Amount:<input type="text" id="amount" value="100"/> <br/>
    <input type="button" value="Transfer" onclick="transferAmount()">
</div>

<script type="text/javascript">

    function transferAmount() {
        // var restEndpoint = "http://localhost/api/victim/transfer-rest"; // to test CORS using a local NodeJS instance
        var restEndpoint = "http://localhost:8080/api/victim/transfer-rest";

        // console.log("xsrf: ", xsrfToken);
        // $http.post()
        $.ajax(restEndpoint, {
            method: "POST",
            xhrFields: { withCredentials: true }, // CORS call to sending credentials
            data: JSON.stringify({
                recipientFullName: $("#fullName").val(),
                recipientIban: $("#iban").val(),
                amount: $("#amount").val()
            }),
            contentType: "application/json",
            success: function (trainings) {
                toastr.success("Money Transferred")
            },
            error: function (error) {
                toastr.error("Failed");
            }
        });
    }
</script>
</body>
</html>
