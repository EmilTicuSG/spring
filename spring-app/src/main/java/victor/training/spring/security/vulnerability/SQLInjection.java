package victor.training.spring.security.vulnerability;

import lombok.RequiredArgsConstructor;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.io.IOException;
import java.util.List;

@RestController
@RequiredArgsConstructor
public class SQLInjection {
  private final JdbcTemplate jdbc;

  public enum OrderCol {
    message,
    id
  }
  @GetMapping("sql-injection")
  public List<String> sqlInjection(@RequestParam OrderCol orderCol) throws IOException {
    List<String> list= jdbc.queryForList("SELECT message FROM MESSAGE " +
                                         "  ORDER BY " + orderCol, String.class);
    // TODO think ORDER BY
    return list;
  }
}
